---
layout: share-distill
title: '[MARL-Message-Adaptor] 1. Framework '
date: 2024-01-25
description: Project
authors: 
    - name: Bumjin Park
      affiliations:
        name: KAIST
img : ''
---


## 메시지에 의한 행동 차이 중요성 

<img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%21900&authkey=%21AN3mJJl1JF5cWZI&width=853&height=480" width="853" height="480" />

---


## 메시지 정의

메시지에 대한 명확한 정의는 

1. 기존 : 에이전트가 다른 에이전트에게 전달할 메시지를 만든다. 
2. 본 연구 : 에이전트가 본인의 행동과 관찰에 대해서 다른 메시지에게 전달한다. 

따라서 본 연구에서는 메시지 자체가 개별 에이전트가 결정된 행동 및 관찰 정보로 부터 유용한 정보로 정의한다. 
행동을 결정할 당시 전달할 수 있는 메시지는 세 가지가 존재한다. 각 에이전트는 아래 정보들을 생성하여 다른 에이전트에게 전달한다. 

* 처리된 관찰 값 : $h_i$
* 행동 및 확률 : $a_i, p_{a_{i}}$
* 다른 행동에 대한 확률 : $P_{a_{i}}$

$$
m_i = (h_i, a_i, p_{a_{i}}, P_{a_{i}})
$$

## 메시지 어뎁터 방식 

어뎁터는 기존 에이전트의 행동에 대한 정보를 바탕으로 이를 보정하는 메시지 기반 모듈을 추가학습하여 모델을 개선한다. 


### Processing Methods 

임의의 개수의 에이전트가 주는 메시지를 처리하기 위해서는 데이터를 pooling하는 것보다 RNN 으로 처리하여 정보를 최대한 보존하는 게 유리하다. 따라서 GRU 방식으로 메시지를 처리하였다. 

* Pooling Message 
* RNN Hidden Message 



### 학습 다이나믹스


### 최종 보상 

#### mpe.simple_spread_v3

|Model| Step1 Return| Step2 Return|
|---|---|---|
|message_v1  |  $-150.91 \pm(106.00)$ | $-112.38 \pm(47.35)$
| action_v1  |   $-173.25 \pm(147.43)$ |  **$-111.77 \pm(38.51)$**


#### Step2: Adaptor 학습 비교 

<img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%21899&authkey=%21ACPyZ9dgwToCcLw&width=660" width="660" height="auto" />

--- 

## 정리 안됨 

1. 메시지는 굉장히 노이즈한 경향성을 보인다. 
2. 메세지에 의존해서 전체 모델을 학습하는 것을 위험하다. (메시지가 noisy 한 경우는 어떻게 되는가? 잘 안되겠지. 불안정하겠지.)
3. 구조적으로 메시지 노이즈를 처리할 수 있는 모듈은 어떤 형태인가?



멀티에이전트에서 통신한다는 것은 정보교환이 발생하는 것을 나타낸다. 협업을 위해서 통신은 필수적이고, 
이에 대하 효과를 명시적으로 확인하기 위해서는 통신의 효용만큼 에이전트의 행동이 개선되어 성능 향상을 보여야 한다. 

멀티에이전트 환경에서는 관찰, 에이전트의 행동과 같은 기본 요소들이 통신과 더불어 반응하여 기존 에이전트의 행동을 제대로 구분되게 보여주지 못한다. 
각 에이전트의 컨트롤에 대한 부분과 통신에 대한 부분을 명시적으로 구분하는 것은 두 가지 장점이 있다. 

1. 기존 비통신 대비 성능 향상. 성능 향상에서 통신에 의한 행동 변화를 보여줌. 
2. 행동 자체의 변화에 대해서 해석할 수 있다. 



통신의 효과를 명시적으로 확인하고 

## 성능 비교 

행동을 관찰하는 것과 관찰 메시지를 전달받는 것은 성능 차이를 보이는가? 
행동을 관찰하는 것과 의도에 대한 메시지를 전달받는 것은 성능 차이를 보이는가? 

|환경 | 에이전트 관찰 | 에이전트 관찰 메시지 | 에이전트 관찰+행동 메시지 |
|  simple_spread_v3 | 000 | 000| 000|
| simple_reference_v3 | 000| 000| 000|
