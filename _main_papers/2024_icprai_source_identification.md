---
layout: distill
title:   'Identifying the Source of Generation  for Large Language Models <strong>[ICPRAI 2024]</strong>' 
date: 2024-04-25
giscus_comments : true
description: This work introduces token-level source identification in the decoding step, which maps the token representation to the reference document. We propose a bi-gram source identifier which has two successive token representations as input.
bibliography: all.bib
authors: 
    - name: Bumjin Park
      affiliations:
        name: KAIST
    - name: Jaesik Choi
      affiliations:
        name: KAIST
img: /assets/main_papers/2024_icprai_source_identification.png
author_names: <tag style="font-weight:800">Bumjin Park</tag>, Jaesik Choi
---

This post is a brief summary of the paper <br>
<it> <strong> [ Identifying the Source of Generation for Large Language Models](). </strong> </it>

* ðŸ†’ Code is available at [Github:fxnnxc/source_identification_of_llm](https://github.com/fxnnxc/source_identification_of_llm)
* This work is accepted at [ICPRAI 2024](https://brain.korea.ac.kr/icprai2024/)

## Problem Statement 

Humans memorize text they seen and use the knowledge in future for any purpose. Similarly, LLMs memorize documents for the purpose of language modeling. This process is can be viewed as "statistical modeling"  of real world text distribution. 

A different between human and LLM is that we learn from text and remember the location of text such as news, books, and websites. However, LLMs do not memorize the source of text as the only information given is the text.  

Learning text distribution is already hard work<d-footnote> Requires many parameters and lots of data. </d-footnote> and memorizing the source of documents can make training hard <d-footnote> We may need additional loss term for the inference of source document and the two objectives can conflict </d-footnote>. Therefore, more realistic approach is to add post hoc process to infer the document from the learned representation of text. 

This work reveals that the inference of document label from the hidden representation of GPT is a trainable connection of two distributions, hiddens and labels.  

Here is an example of the source identification from [Llama2 model](https://huggingface.co/docs/transformers/main/model_doc/llama2). 

<p align="center" >
<img src="/assets/main_papers/2024_icprai_source_identification.png" width="80%">
</p> 




## Proposed Approach

The proposed method includes the two steps. 
1. GPT is trained to memorize documents <d-footnote> This work assumes that the Wiki pages are already memorized in the pretrained state of open sourced LLMs </d-footnote>.  
2. A source identifier, which is a multi-layer MLP is trained to predict the labels from the hidden representation of tokens. 
<br>
<p align="center" >
<img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%212368&authkey=%21AMnw4HaL72CIXRU&width=1596&height=989" width="90%"/>
</p> 




## Proposed Methods

Our prediction problem is a token-level rather than sentence-level. That means, we predict labels at each token location. One important property of GPT is that the distribution of the next word is combined over several documents. As such, a single sentence generated by GPT is a mixture of documents at every token location. We contribute by proposing

1. Token-level identification of documents 
2. Bi-gram representation of predict token-level document. 


<p align="center" >
<img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%212369&authkey=%21AAgFi2h27rNHXxU&width=1568&height=734" width="100%"/>
</p> 



One interesting observation is that the bigram representation generalize better than unigram or trigram representations. This observation shed light on the possibility of token-level source identification of AI generation.

<br>
<p align="center" >
<img src="https://onedrive.live.com/embed?resid=AE042A624064F8CA%212370&authkey=%21AAD0ACPktw_zwfs&width=1610&height=650" width="80%" />
</p> 

The paper includes more experiments and discussion on the token-level prediction. 

## Conclusion 

AI Generation shows remarkable progress in recent years including Llama3, Claude3,... etc. 
As the AI models learns from data provided by developers, we need to leave a tag to trace the data origin and add other information for safety, such as watermarks. This work contribute to the AI safety community by investigating the hidden representation of LLMs for the purpose of tracking origin.  

<h2 id="how_to_cite"> How to Cite </h2>

<blockquote>
TBD
</blockquote>

* Contact : bumjin@kaist.a.kr